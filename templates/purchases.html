<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1">

<head>
<style>
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}

.btn {
  border: none;
  background-color: inherit;
  padding: 14px 28px;
  font-size: 16px;
  cursor: pointer;
  display: inline-block;
}

.btnSmall {
  border: none;
  background-color: inherit;
  padding: 9px 28px;
  font-size: 16px;
  cursor: pointer;
  display: inline-block;
}

.btn:hover {background: #eee;}

.purchases {color: green;}
.budgets {color: dodgerblue;}
.add_purchase {color: purple;}
.delete {color: red;}

</style>
</head>

<body>
    <button class="btn purchases" onclick="location.href='http://inherentvice.pythonanywhere.com/site/purchases/{{ month }}/{{ year }}/{{ category }}'">Purchases</button>
    <button class="btn budgets" onclick="location.href='http://inherentvice.pythonanywhere.com/site/budgets'">Budgets</button>
    <button class="btn add_purchase" onclick="location.href='http://inherentvice.pythonanywhere.com/site/add_purchase'">Add Purchase</button>

<h2>Purchases for {{month}}/{{year}} and category = {{category}}</h2>
<h3>Total Spent for {{month}}/{{year}}: ${{spent_in_month}}</h3>
<h3>Monthly Budget: ${{month_limit}}</h3>
<h3>Total Spent for 2019: ${{spent_in_year}}</h3>
<h3>Yearly Budget: ${{year_limit}}</h3>
<table>
  <tr>
    <th>Item</th>
    <th>Price</th>
    <th>Category</th>
    <th>Date</th>
    <th>Note</th>
    <th>Delete?</th>
  </tr>
  {% for purchase in purchases %}
    <tr>
        <td>{{ purchase[1] }}</td>
        <td>${{ purchase[2] }}</td>
        <td>{{ purchase[3] }}</td>
        <td>{{ purchase[4] }}</td>
        <td>{{ purchase[5] }}</td>
        <td><button class="btnSmall delete" id="{{purchase[0]}}" onclick="deletePurchase(this.id)">{{ purchase[0] }}</button></td>
    </tr>
  {% endfor %}

</table>

<script>
function deletePurchase(purchase_id) {

    var xhr = new XMLHttpRequest();
    var url = "http://inherentvice.pythonanywhere.com/" + purchase_id;
    xhr.open("DELETE", url, true);
    xhr.setRequestHeader('Content-Type', 'application/json');
xhr.send(JSON.stringify({
}));
xhr.onload = function() {
  console.log("Deleted")
  console.log(this.responseText);
  location.reload();
  alert(this.responseText);
}




}



</script>

</body>

